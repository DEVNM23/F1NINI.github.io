"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[574],{1201:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(5155),n=r(2596);function l(e){let{position:t,teamColor:r,short:l,className:s}=e;return(0,a.jsxs)("div",{id:"walkthrough-driver-position",className:(0,n.A)("flex w-fit items-center justify-between gap-0.5 rounded-lg bg-zinc-500 px-1 py-1 font-black",s),style:{backgroundColor:"#".concat(r)},children:[t&&(0,a.jsx)("p",{className:"px-1 text-xl leading-none",children:t}),(0,a.jsx)("div",{className:"flex h-min w-min items-center justify-center rounded-md bg-white px-1",children:(0,a.jsx)("p",{className:"font-mono text-zinc-500",style:{...r&&{color:"#".concat(r)}},children:l})})]})}},2263:(e,t,r)=>{r.d(t,{C:()=>n});var a=r(6786);let n=(0,r(5453).v)()((0,a.eh)((0,a.Zr)(e=>({delay:0,setDelay:t=>e({delay:t}),speedUnit:"metric",setSpeedUnit:t=>e({speedUnit:t}),showCornerNumbers:!1,setShowCornerNumbers:t=>e({showCornerNumbers:t}),carMetrics:!1,setCarMetrics:t=>e({carMetrics:t}),tableHeaders:!1,setTableHeaders:t=>e({tableHeaders:t}),showBestSectors:!0,setShowBestSectors:t=>e({showBestSectors:t}),showMiniSectors:!0,setShowMiniSectors:t=>e({showMiniSectors:t}),oledMode:!1,setOledMode:t=>e({oledMode:t}),useSafetyCarColors:!0,setUseSafetyCarColors:t=>e({useSafetyCarColors:t}),favoriteDrivers:[],setFavoriteDrivers:t=>e({favoriteDrivers:t}),removeFavoriteDriver:t=>e(e=>({favoriteDrivers:e.favoriteDrivers.filter(e=>e!==t)})),raceControlChime:!1,setRaceControlChime:t=>e({raceControlChime:t}),raceControlChimeVolume:50,setRaceControlChimeVolume:t=>e({raceControlChimeVolume:t}),delayIsPaused:!0,setDelayIsPaused:t=>e({delayIsPaused:t})}),{name:"settings-storage",storage:(0,a.KU)(()=>localStorage),onRehydrateStorage:e=>()=>e.setDelayIsPaused(!1)})))},2867:(e,t,r)=>{r.d(t,{A:()=>b});var a=r(5155),n=r(2115),l=r(2596);let s=async e=>{try{let t=new Date().getFullYear(),r=await fetch("https://api.multiviewer.app/api/v1/circuits/".concat(e,"/").concat(t),{next:{revalidate:7200}});if(!r.ok)return console.error("Failed to fetch map",r),null;return r.json()}catch(e){return console.error("Failed to fetch map",e),null}};var o=r(7852),i=r(2263),c=r(6859),u=r(7067);let d=e=>Math.PI/180*e,m=(e,t,r,a,n)=>{let l=Math.cos(d(r)),s=Math.sin(d(r));return{y:(e-=a)*l-(t-=n)*s+a,x:t*l+e*s+n}},h=(e,t,r,a)=>Math.sqrt(Math.pow(r-e,2)+Math.pow(a-t,2)),x=(e,t)=>{let r=1/0,a=-1;for(let n=0;n<t.length;n++){let l=h(e.x,e.y,t[n].x,t[n].y);l<r&&(r=l,a=n)}return a},p=e=>{let t=[],r=e.x.map((t,r)=>({x:t,y:e.y[r]}));for(let r=0;r<e.marshalSectors.length;r++)t.push({number:r+1,start:e.marshalSectors[r].trackPosition,end:e.marshalSectors[r+1]?e.marshalSectors[r+1].trackPosition:e.marshalSectors[0].trackPosition,points:[]});let a=t.map(e=>x(e.start,r));for(let e=0;e<a.length;e++){let n=a[e],l=a[e+1]?a[e+1]:a[0];n<l?t[e].points=r.slice(n,l+1):t[e].points=r.slice(n).concat(r.slice(0,l+1))}return t},f=e=>{let t=null==e?void 0:e.sort(u.P$).filter(e=>"YELLOW"===e.flag||"DOUBLE YELLOW"===e.flag||"CLEAR"===e.flag);if(!t)return new Set;let r=new Set,a=new Set;for(let e=0;e<t.length;e++){let n=t[e];if("Track"===n.scope&&"CLEAR"!==n.flag){for(let e=0;e<100;e++)a.add(e);break}if("Sector"===n.scope){if(!n.sector||r.has(n.sector))continue;"CLEAR"===n.flag?r.add(n.sector):a.add(n.sector)}}return a},v=(e,t)=>"stroke-white"===e.color&&"stroke-white"!==t.color?-1:"stroke-white"!==e.color&&"stroke-white"===t.color?1:e.number-t.number,g=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"stroke-white",a=arguments.length>3?arguments[3]:void 0;return t?a.has(e.number)?r:"stroke-white":r};function b(){let e=(0,i.C)(e=>e.showCornerNumbers),t=(0,i.C)(e=>e.favoriteDrivers),r=(0,o.WG)(e=>e.positions),l=(0,o.D$)(e=>null==e?void 0:e.driverList),u=(0,o.D$)(e=>null==e?void 0:e.trackStatus),h=(0,o.D$)(e=>null==e?void 0:e.timingData),x=(0,o.D$)(e=>{var t;return null==e||null==(t=e.raceControlMessages)?void 0:t.messages}),b=(0,o.D$)(e=>{var t;return null==e||null==(t=e.sessionInfo)?void 0:t.meeting.circuit.key}),[[S,w,j,D],N]=(0,n.useState)([null,null,null,null]),[[M,P],A]=(0,n.useState)([null,null]),[L,z]=(0,n.useState)(null),[T,F]=(0,n.useState)([]),[I,E]=(0,n.useState)([]),[O,Y]=(0,n.useState)(0),[W,R]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{if(!b)return;let e=await s(b);if(!e)return;let t=(Math.max(...e.x)-Math.min(...e.x))/2,r=(Math.max(...e.y)-Math.min(...e.y))/2,a=e.rotation+90,n=p(e).map(e=>({...e,start:m(e.start.x,e.start.y,a,t,r),end:m(e.end.x,e.end.y,a,t,r),points:e.points.map(e=>m(e.x,e.y,a,t,r))})),l=e.corners.map(e=>({number:e.number,pos:m(e.trackPosition.x,e.trackPosition.y,a,t,r),labelPos:m(e.trackPosition.x+540*Math.cos(d(e.angle)),e.trackPosition.y+540*Math.sin(d(e.angle)),a,t,r)})),o=e.x.map((n,l)=>m(n,e.y[l],a,t,r)),i=o.map(e=>e.x),c=o.map(e=>e.y),u=Math.min(...i)-1e3,h=Math.min(...c)-1e3,x=Math.max(...i)-u+2e3,f=Math.max(...c)-h+2e3,v=m(e.x[0],e.y[0],a,t,r),g=o[3].x-o[0].x,y=180/Math.PI*Math.atan2(o[3].y-o[0].y,g);A([t,r]),N([u,h,x,f]),F(n),z(o),Y(a),E(l),R({x:v.x,y:v.y,startAngle:y})})()},[b]);let X=(0,n.useMemo)(()=>f(x),[x]),U=(0,n.useMemo)(()=>{let e=(0,c.L)((null==u?void 0:u.status)?parseInt(u.status):void 0);return T.map(t=>{let r=g(t,null==e?void 0:e.bySector,null==e?void 0:e.trackColor,X);return{color:r,pulse:null==e?void 0:e.pulse,number:t.number,strokeWidth:"stroke-white"===r?60:120,d:"M".concat(t.points[0].x,",").concat(t.points[0].y," ").concat(t.points.map(e=>"L".concat(e.x,",").concat(e.y)).join(" "))}}).sort(v)},[u,T,X]);return L&&S&&w&&j&&D?(0,a.jsxs)("svg",{viewBox:"".concat(S," ").concat(w," ").concat(j," ").concat(D),className:"h-full w-full xl:max-h-screen",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{className:"stroke-gray-800",strokeWidth:300,strokeLinejoin:"round",fill:"transparent",d:"M".concat(L[0].x,",").concat(L[0].y," ").concat(L.map(e=>"L".concat(e.x,",").concat(e.y)).join(" "))}),U.map(e=>{let t=e.pulse?{animation:"".concat(100*e.pulse,"ms linear infinite pulse")}:{};return(0,a.jsx)("path",{className:e.color,strokeWidth:e.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round",fill:"transparent",d:e.d,style:t},"map.sector.".concat(e.number))}),W&&(0,a.jsx)("rect",{x:W.x-75,y:W.y,width:240,height:20,fill:"red",stroke:"red",strokeWidth:70,transform:"rotate(".concat(W.startAngle+90,", ").concat(W.x+25,", ").concat(W.y,")")}),e&&I.map(e=>(0,a.jsx)(y,{number:e.number,x:e.labelPos.x,y:e.labelPos.y},"corner.".concat(e.number))),M&&P&&r&&l&&(0,a.jsxs)(a.Fragment,{children:[r["241"]&&0!==r["241"].Z&&(0,a.jsx)(C,{rotation:O,centerX:M,centerY:P,pos:r["241"],color:"229971"},"safety.car.241"),r["242"]&&0!==r["242"].Z&&(0,a.jsx)(C,{rotation:O,centerX:M,centerY:P,pos:r["242"],color:"229971"},"safety.car.242"),r["243"]&&0!==r["243"].Z&&(0,a.jsx)(C,{rotation:O,centerX:M,centerY:P,pos:r["243"],color:"B90F09"},"safety.car.243"),Object.values(l).reverse().filter(e=>!!r[e.racingNumber].X&&!!r[e.racingNumber].Y).map(e=>{let n=null==h?void 0:h.lines[e.racingNumber],l=!!n&&(n.knockedOut||n.stopped||n.retired),s=!!n&&n.inPit;return(0,a.jsx)(k,{favoriteDriver:t.length>0&&t.includes(e.racingNumber),name:e.tla,color:e.teamColour,pit:s,hidden:l,pos:r[e.racingNumber],rotation:O,centerX:M,centerY:P},"map.driver.".concat(e.racingNumber))})]})]}):(0,a.jsx)("div",{className:"h-full w-full p-2",style:{minHeight:"35rem"},children:(0,a.jsx)("div",{className:"h-full w-full animate-pulse rounded-lg bg-zinc-800"})})}let y=e=>{let{number:t,x:r,y:n}=e;return(0,a.jsx)("text",{x:r,y:n,className:"fill-zinc-700",fontSize:300,fontWeight:"semibold",children:t})},k=e=>{let{pos:t,name:r,color:n,favoriteDriver:s,pit:o,hidden:i,rotation:c,centerX:u,centerY:d}=e,h=m(t.X,t.Y,c,u,d),x=["translateX(".concat(h.x,"px)"),"translateY(".concat(h.y,"px)")].join(" ");return(0,a.jsxs)("g",{className:(0,l.A)("fill-zinc-700",{"opacity-30":o},{"opacity-0!":i}),style:{transition:"all 1s linear",transform:x,...n&&{fill:"#".concat(n)}},children:[(0,a.jsx)("circle",{id:"map.driver.circle",r:120}),(0,a.jsx)("text",{id:"map.driver.text",fontWeight:"bold",fontSize:360,style:{transform:"translateX(150px) translateY(-120px)"},children:r}),s&&(0,a.jsx)("circle",{id:"map.driver.favorite",className:"stroke-sky-400",r:180,fill:"transparent",strokeWidth:40,style:{transition:"all 1s linear"}})]})},C=e=>{let{pos:t,rotation:r,centerX:n,centerY:l,color:s}=e,o=(0,i.C)(e=>e.useSafetyCarColors);return(0,a.jsx)(k,{name:"Safety Car",pos:t,rotation:r,centerX:n,centerY:l,favoriteDriver:!1,pit:!1,hidden:!1,color:o?s:"DDD"})}},3781:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(5155),n=r(2596);function l(e){var t,r,l,s,o,i,c,u;let{timingDriver:d,sessionPart:m}=e,h=null!=(o=null!=(s=null!=(l=d.gapToLeader)?l:d.stats?d.stats[m?m-1:0].timeDiffToFastest:void 0)?s:d.timeDiffToFastest)?o:"",x=null!=(u=null!=(c=null!=(i=null==(t=d.intervalToPositionAhead)?void 0:t.value)?i:d.stats?d.stats[m?m-1:0].timeDifftoPositionAhead:void 0)?c:d.timeDiffToPositionAhead)?u:"",p=null==(r=d.intervalToPositionAhead)?void 0:r.catching;return(0,a.jsxs)("div",{className:"place-self-start",children:[(0,a.jsx)("p",{className:(0,n.A)("text-lg leading-none font-medium tabular-nums",{"text-emerald-500":p,"text-zinc-500":!x}),children:x||"-- ---"}),(0,a.jsx)("p",{className:"text-sm leading-none text-zinc-500 tabular-nums",children:h||"-- ---"})]})}},4432:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(5155),n=r(2596);function l(e){let{on:t,possible:r,inPit:l,pitOut:s}=e,o=l||s;return(0,a.jsx)("span",{className:(0,n.A)("text-md inline-flex h-8 w-full items-center justify-center rounded-md border-2 font-mono font-black",{"border-zinc-700 text-zinc-700":!o&&!t&&!r,"border-zinc-400 text-zinc-400":!o&&!t&&r,"border-emerald-500 text-emerald-500":!o&&t,"border-cyan-500 text-cyan-500":o}),children:o?"PIT":"DRS"})}},5845:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(5155),n=r(2596);function l(e){let{last:t,best:r,hasFastest:l}=e;return(0,a.jsxs)("div",{className:"place-self-start",children:[(0,a.jsx)("p",{className:(0,n.A)("text-lg leading-none font-medium tabular-nums",{"text-violet-600!":t.overallFastest,"text-emerald-500!":t.personalFastest,"text-zinc-500!":!t.value}),children:t.value?t.value:"-- -- ---"}),(0,a.jsx)("p",{className:(0,n.A)("text-sm leading-none text-zinc-500 tabular-nums",{"text-violet-600!":l,"text-zinc-500!":!r.value}),children:r.value?r.value:"-- -- ---"})]})}},5971:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(5155),n=r(2596);function l(e){let{timingDriver:t,gridPos:r}=e,l=r&&r-parseInt(t.position),s=l&&l>0,o=l&&l<0,i=t.knockedOut?"OUT":t.cutoff?"CUTOFF":t.retired?"RETIRED":t.stopped?"STOPPED":t.inPit?"PIT":t.pitOut?"PIT OUT":null;return(0,a.jsxs)("div",{className:"place-self-start",children:[(0,a.jsx)("p",{className:(0,n.A)("text-lg leading-none font-medium tabular-nums",{"text-emerald-500":s,"text-red-500":o,"text-zinc-500":!s&&!o}),children:void 0!==l?s?"+".concat(l):o?l:"-":"".concat(t.numberOfLaps,"L")}),(0,a.jsx)("p",{className:"text-sm leading-none text-zinc-500",children:null!=i?i:"-"})]})}},6859:(e,t,r)=>{r.d(t,{L:()=>a});let a=e=>{var t;let r={1:{message:"Track Clear",color:"bg-emerald-500",trackColor:"stroke-white",hex:"#34b981"},2:{message:"Yellow Flag",color:"bg-amber-400",trackColor:"stroke-amber-400",bySector:!0,hex:"#fbbf24"},3:{message:"Flag",color:"bg-amber-400",trackColor:"stroke-amber-400",bySector:!0,hex:"#fbbf24"},4:{message:"Safety Car",color:"bg-amber-400",trackColor:"stroke-amber-400",hex:"#fbbf24"},5:{message:"Red Flag",color:"bg-red-500",trackColor:"stroke-red-500",hex:"#ef4444"},6:{message:"VSC Deployed",color:"bg-amber-400",trackColor:"stroke-amber-400",hex:"#fbbf24"},7:{message:"VSC Ending",color:"bg-amber-400",trackColor:"stroke-amber-400",hex:"#fbbf24"}};return e?null!=(t=r[e])?t:r[0]:null}},7067:(e,t,r)=>{r.d(t,{P$:()=>l,nd:()=>n});var a=r(2940);let n=(e,t)=>parseInt(e.position)-parseInt(t.position),l=(e,t)=>(0,a.utc)(t.utc).diff((0,a.utc)(e.utc))},7852:(e,t,r)=>{r.d(t,{D$:()=>n,WG:()=>s,XG:()=>l});var a=r(5453);let n=(0,a.v)(e=>({heartbeat:null,extrapolatedClock:null,topThree:null,timingStats:null,timingAppData:null,weatherData:null,trackStatus:null,sessionStatus:null,driverList:null,raceControlMessages:null,sessionInfo:null,sessionData:null,lapCount:null,timingData:null,teamRadio:null,championshipPrediction:null,set:t=>{e(t)},update:t=>{e(t)}})),l=(0,a.v)(e=>({carsData:null,set:t=>e({carsData:t})})),s=(0,a.v)(e=>({positions:null,set:t=>e({positions:t})}))}}]);