(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[278],{4094:(e,t,n)=>{Promise.resolve().then(n.bind(n,5699))},5084:(e,t,n)=>{"use strict";n.d(t,{N:()=>x});var r=n(5155),l=n(2115),a=n(7728),i=n(6168),s=n(9025),o=n(430),c=n(7471);class u extends l.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,n=e instanceof HTMLElement&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=n-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function f(e){let{children:t,isPresent:n,anchorX:a}=e,i=(0,l.useId)(),s=(0,l.useRef)(null),o=(0,l.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:f}=(0,l.useContext)(c.Q);return(0,l.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:l,right:c}=o.current;if(n||!s.current||!e||!t)return;s.current.dataset.motionPopId=i;let u=document.createElement("style");return f&&(u.nonce=f),document.head.appendChild(u),u.sheet&&u.sheet.insertRule('\n          [data-motion-pop-id="'.concat(i,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===a?"left: ".concat(l):"right: ".concat(c),"px !important;\n            top: ").concat(r,"px !important;\n          }\n        ")),()=>{document.head.removeChild(u)}},[n]),(0,r.jsx)(u,{isPresent:n,childRef:s,sizeRef:o,children:l.cloneElement(t,{ref:s})})}let d=e=>{let{children:t,initial:n,isPresent:a,onExitComplete:s,custom:c,presenceAffectsLayout:u,mode:d,anchorX:m}=e,p=(0,i.M)(h),g=(0,l.useId)(),x=!0,w=(0,l.useMemo)(()=>(x=!1,{id:g,initial:n,isPresent:a,custom:c,onExitComplete:e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;s&&s()},register:e=>(p.set(e,!1),()=>p.delete(e))}),[a,p,s]);return u&&x&&(w={...w}),(0,l.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[a]),l.useEffect(()=>{a||p.size||!s||s()},[a]),"popLayout"===d&&(t=(0,r.jsx)(f,{isPresent:a,anchorX:m,children:t})),(0,r.jsx)(o.t.Provider,{value:w,children:t})};function h(){return new Map}var m=n(4905);let p=e=>e.key||"";function g(e){let t=[];return l.Children.forEach(e,e=>{(0,l.isValidElement)(e)&&t.push(e)}),t}let x=e=>{let{children:t,custom:n,initial:o=!0,onExitComplete:c,presenceAffectsLayout:u=!0,mode:f="sync",propagate:h=!1,anchorX:x="left"}=e,[w,v]=(0,m.xQ)(h),y=(0,l.useMemo)(()=>g(t),[t]),j=h&&!w?[]:y.map(p),b=(0,l.useRef)(!0),C=(0,l.useRef)(y),P=(0,i.M)(()=>new Map),[E,R]=(0,l.useState)(y),[N,S]=(0,l.useState)(y);(0,s.E)(()=>{b.current=!1,C.current=y;for(let e=0;e<N.length;e++){let t=p(N[e]);j.includes(t)?P.delete(t):!0!==P.get(t)&&P.set(t,!1)}},[N,j.length,j.join("-")]);let M=[];if(y!==E){let e=[...y];for(let t=0;t<N.length;t++){let n=N[t],r=p(n);j.includes(r)||(e.splice(t,0,n),M.push(n))}return"wait"===f&&M.length&&(e=M),S(g(e)),R(y),null}let{forceRender:k}=(0,l.useContext)(a.L);return(0,r.jsx)(r.Fragment,{children:N.map(e=>{let t=p(e),l=(!h||!!w)&&(y===N||j.includes(t));return(0,r.jsx)(d,{isPresent:l,initial:(!b.current||!!o)&&void 0,custom:n,presenceAffectsLayout:u,mode:f,onExitComplete:l?void 0:()=>{if(!P.has(t))return;P.set(t,!0);let e=!0;P.forEach(t=>{t||(e=!1)}),e&&(null==k||k(),S(C.current),h&&(null==v||v()),c&&c())},anchorX:x,children:e},t)})})}},5453:(e,t,n)=>{"use strict";n.d(t,{v:()=>o});var r=n(2115);let l=e=>{let t,n=new Set,r=(e,r)=>{let l="function"==typeof e?e(t):e;if(!Object.is(l,t)){let e=t;t=(null!=r?r:"object"!=typeof l||null===l)?l:Object.assign({},t,l),n.forEach(n=>n(t,e))}},l=()=>t,a={setState:r,getState:l,getInitialState:()=>i,subscribe:e=>(n.add(e),()=>n.delete(e))},i=t=e(r,l,a);return a},a=e=>e?l(e):l,i=e=>e,s=e=>{let t=a(e),n=e=>(function(e,t=i){let n=r.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return r.useDebugValue(n),n})(t,e);return Object.assign(n,t),n},o=e=>e?s(e):s},5699:(e,t,n)=>{"use strict";n.d(t,{WeatherMap:()=>P});var r=n(5155),l=n(2115),a=n(9101),i=n.n(a);n(6467);let s=e=>e?(Object.keys(e).forEach(t=>void 0===e[t]?delete e[t]:{}),"?".concat(new URLSearchParams(e))):"",o=async e=>{let t=s({q:e,format:"jsonv2"}),n=await fetch("https://nominatim.openstreetmap.org/search".concat(t)),r=await n.json();if(n.ok&&r.length>0){let{lon:e,lat:t}=r.sort((e,t)=>t.importance-e.importance)[0];return{lon:parseFloat(e),lat:parseFloat(t)}}return null},c=async()=>{try{let e=await fetch("https://api.rainviewer.com/public/weather-maps.json");if(!e.ok)return null;return e.json()}catch(e){return null}};var u=n(7852),f=n(5977),d=n(2940),h=n(7471),m=n(6168),p=n(9967);function g(e){let t=(0,m.M)(()=>(0,p.OQ)(e)),{isStatic:n}=(0,l.useContext)(h.Q);if(n){let[,n]=(0,l.useState)(e);(0,l.useEffect)(()=>t.on("change",n),[])}return t}class x{constructor(){this.componentControls=new Set}subscribe(e){return this.componentControls.add(e),()=>this.componentControls.delete(e)}start(e,t){this.componentControls.forEach(n=>{n.start(e.nativeEvent||e,t)})}}let w=()=>new x;var v=n(6352),y=n(5084);function j(e){var t;let{x:n,containerRef:r}=e,l=null==(t=r.current)?void 0:t.getBoundingClientRect();return l?Math.max(0,Math.min((n-l.x)/l.width,1)):0}function b(e,t){let n=(0,l.useRef)(null),r=(0,l.useRef)(e);return(0,l.useEffect)(()=>{r.current=e},[e]),(0,l.useEffect)(()=>{if("number"==typeof t)return n.current=setInterval(()=>r.current(),t),()=>{n.current&&clearInterval(n.current)}},[t]),n}function C(e){let{frames:t,setFrame:n,playing:a}=e,i=(0,l.useRef)(null),s=(0,l.useRef)(null),o=(0,l.useRef)(null),c=g(0),u=g(0),f=(0,m.M)(w),[h,p]=(0,l.useState)(!1),[x,C]=(0,l.useState)(0),P=t[0].time,E=t[t.length-1].time-P;(0,l.useEffect)(()=>{let e=P+x,r=t.findLast(t=>t.time<=e);r&&n(r.id)},[x,t,n,P]),b(()=>{x<E?C(e=>e+600):C(0)},a?500:null),b(()=>{if(u.get()<E){u.set(u.get()+12);let e=function(e){var t;let{progress:n,containerRef:r}=e,l=null==(t=r.current)?void 0:t.getBoundingClientRect();return l?n*l.width:0}({containerRef:s,progress:u.get()/E});c.set(e)}else u.set(0),c.set(0)},a?10:null);let R=E/9;return(0,r.jsxs)("div",{className:"relative w-full select-none",children:[(0,r.jsxs)("div",{className:"relative mt-2",onPointerDown:e=>{let t=j({containerRef:s,x:e.clientX});f.start(e,{snapToCursor:!0}),C(Math.floor(t*E)),u.set(t*E)},children:[(0,r.jsx)("div",{ref:s,className:"h-1 w-full rounded-full bg-zinc-800"}),(0,r.jsx)("div",{className:"absolute inset-0",ref:i,children:(0,r.jsxs)(v.P.button,{className:"absolute flex cursor-ew-resize items-center justify-center rounded-full active:cursor-grabbing",ref:o,drag:"x",dragConstraints:i,dragControls:f,dragElastic:0,dragMomentum:!1,style:{x:c},onDrag:()=>{if(!o.current)return;let e=o.current.getBoundingClientRect(),t=j({containerRef:s,x:e.x+e.width/2});C(Math.floor(t*E)),u.set(t*E)},onDragStart:()=>p(!0),onPointerDown:()=>p(!0),onPointerUp:()=>p(!1),onDragEnd:()=>p(!1),children:[(0,r.jsx)(v.P.div,{animate:{scale:h?1.2:1},transition:{type:"tween",duration:.15},initial:!1,className:"-mt-2 h-5 w-2 rounded-full bg-zinc-300"}),(0,r.jsx)(y.N,{children:h&&(0,r.jsx)(v.P.p,{className:"absolute text-sm font-medium tracking-wide tabular-nums",initial:{y:12,opacity:0},animate:{y:20,opacity:1},exit:{y:[20,12],opacity:0},children:(0,d.unix)(P+x).format("HH:mm")})})]})})]}),(0,r.jsx)("div",{className:"mt-4 flex flex-row justify-between",children:Array.from({length:10}).map((e,t)=>(0,r.jsx)("div",{className:"text-xs text-zinc-500",children:(0,d.unix)(P+t*R).format("HH:mm")},t))})]})}function P(){let e=(0,u.D$)(e=>{var t;return null==e||null==(t=e.sessionInfo)?void 0:t.meeting}),[t,n]=(0,l.useState)(!0),s=(0,l.useRef)(null),d=(0,l.useRef)(null),[h,m]=(0,l.useState)(!1),[p,g]=(0,l.useState)([]),x=(0,l.useRef)(0),w=async()=>{if(!d.current)return;let e=await c();if(!e)return;let t=[...e.radar.past,...e.radar.nowcast];for(let n=0;n<t.length;n++){let r=t[n];d.current.addLayer({id:"rainviewer-frame-".concat(n),type:"raster",source:{type:"raster",tiles:["".concat(e.host,"/").concat(r.path,"/256/{z}/{x}/{y}/8/1_0.webp")],tileSize:256},paint:{"raster-opacity":0,"raster-fade-duration":200,"raster-resampling":"nearest"}})}g(t.map((e,t)=>({time:e.time,id:t})))};return(0,l.useEffect)(()=>{(async()=>{if(!s.current||!e)return;let[t,r]=await Promise.all([o("".concat(e.country.name,", ").concat(e.location," circuit")),o("".concat(e.country.name,", ").concat(e.location," autodrome"))]),l=t||r,c=new(i()).Map({container:s.current,style:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",center:l?[l.lon,l.lat]:void 0,zoom:10,canvasContextAttributes:{antialias:!0}});c.on("load",async()=>{n(!1),l&&new a.Marker().setLngLat([l.lon,l.lat]).addTo(c),await w()}),d.current=c})()},[e]),(0,r.jsxs)("div",{className:"relative h-full w-full",children:[(0,r.jsx)("div",{ref:s,className:"absolute h-full w-full"}),!t&&p.length>0&&(0,r.jsxs)("div",{className:"absolute right-0 bottom-0 left-0 z-20 m-2 flex gap-4 rounded-lg bg-black/80 p-4 backdrop-blur-xs md:right-auto md:w-lg",children:[(0,r.jsx)(f.A,{playing:h,onClick:()=>m(e=>!e)}),(0,r.jsx)(C,{frames:p,setFrame:e=>{var t,n;null==(t=d.current)||t.setPaintProperty("rainviewer-frame-".concat(x.current),"raster-opacity",0),null==(n=d.current)||n.setPaintProperty("rainviewer-frame-".concat(e),"raster-opacity",.8),x.current=e},playing:h})]}),t&&(0,r.jsx)("div",{className:"h-full w-full animate-pulse rounded-lg bg-zinc-800"})]})}},5977:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(5155),l=n(2596),a=n(5084),i=n(6352);function s(e){let{id:t,className:n,playing:s,loading:o=!1,onClick:c}=e,u={initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5}};return(0,r.jsx)("div",{id:t,className:(0,l.$)("flex h-8 w-8 cursor-pointer items-center justify-center",n),onClick:c,children:(0,r.jsxs)(a.N,{children:[!s&&!o&&(0,r.jsx)(i.P.svg,{initial:u.initial,animate:u.animate,exit:u.exit,width:"13",height:"16",viewBox:"0 0 13 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)(i.P.path,{d:"M12 6.26795C13.3333 7.03775 13.3333 8.96225 12 9.73205L3 14.9282C1.66667 15.698 0 14.7358 0 13.1962L0 2.80385C0 1.26425 1.66667 0.301996 3 1.0718L12 6.26795Z",fill:"white"})}),s&&(0,r.jsxs)(i.P.svg,{initial:u.initial,animate:u.animate,exit:u.exit,width:"10",height:"14",viewBox:"0 0 10 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)(i.P.rect,{x:"7",width:"3",height:"14",rx:"1.5",fill:"white"}),(0,r.jsx)(i.P.rect,{width:"3",height:"14",rx:"1.5",fill:"white"})]}),!s&&o&&(0,r.jsxs)(i.P.svg,{initial:u.initial,animate:u.animate,exit:u.exit,width:"24",height:"24",viewBox:"0 0 24 24",fill:"#fff",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("circle",{className:"pulse-loading-spinner",cx:"12",cy:"12",r:"0"}),(0,r.jsx)("circle",{className:"pulse-loading-spinner",style:{animationDelay:".6s"},cx:"12",cy:"12",r:"0"})]})]})})}},6467:()=>{},7852:(e,t,n)=>{"use strict";n.d(t,{D$:()=>l,WG:()=>i,XG:()=>a});var r=n(5453);let l=(0,r.v)(e=>({heartbeat:null,extrapolatedClock:null,topThree:null,timingStats:null,timingAppData:null,weatherData:null,trackStatus:null,sessionStatus:null,driverList:null,raceControlMessages:null,sessionInfo:null,sessionData:null,lapCount:null,timingData:null,teamRadio:null,championshipPrediction:null,set:t=>{e(t)},update:t=>{e(t)}})),a=(0,r.v)(e=>({carsData:null,set:t=>e({carsData:t})})),i=(0,r.v)(e=>({positions:null,set:t=>e({positions:t})}))}},e=>{var t=t=>e(e.s=t);e.O(0,[466,586,600,457,441,684,358],()=>t(4094)),_N_E=e.O()}]);